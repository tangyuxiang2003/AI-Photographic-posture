<!-- camera.wxml -->
<view class="camera-container" bindtap="onScreenTap">
  <!-- 顶部黑色功能区 -->
  <view class="top-controls">
    <view class="top-controls-inner">
      <!-- 闪光灯控制 -->
      <view class="control-icon flash-control" bindtap="toggleFlash">
        <image src="{{flash === 'on' ? '/images/flash-on.png' : '/images/flash-off.png'}}" mode="widthFix"></image>
      </view>
      <!-- 倒计时控制 -->
      <view class="control-icon timer-control {{timerEnabled ? 'on' : ''}}" bindtap="toggleTimer">
        <image src="/images/timer-off.png" mode="widthFix"></image>
        <text class="timer-text">{{timerEnabled ? timerSeconds + 's' : ''}}</text>
      </view>
    </view>
  </view>

  <!-- 中间取景区域（被上下黑区包围） -->
  <view class="camera-preview">
    <camera 
      style="width: 100%; height: 100%;"
      device-position="{{cameraPosition}}" 
      flash="{{flash}}"
      binderror="onCameraError"
    ></camera>
    
    <!-- 九宫格辅助线 -->
    <view class="grid-overlay">
      <view class="grid-line grid-line-v" style="left: 33.33%;"></view>
      <view class="grid-line grid-line-v" style="left: 66.66%;"></view>
      <view class="grid-line grid-line-h" style="top: 33.33%;"></view>
      <view class="grid-line grid-line-h" style="top: 66.66%;"></view>
    </view>
  </view>

  <!-- 放大的参考图（显示在左下角黑色区域上方） -->
  <view class="enlarged-reference {{enlargedImage ? 'show' : ''}} {{isMaxEnlarged ? 'max-enlarged' : ''}}" wx:if="{{enlargedImage}}" catchtap="onCloseEnlarged">
    <image src="{{enlargedImage}}" mode="aspectFit"></image>
  </view>

  <!-- 底部黑色功能区 -->
  <view class="bottom-controls" catchtap="stopPropagation">
    <!-- 生成图片缩略图列表（横向滚动） -->
    <view class="thumbnail-list" wx:if="{{generatedImages.length > 0}}">
      <scroll-view scroll-x="true" class="thumbnail-scroll">
        <view class="thumbnail-item" wx:for="{{generatedImages}}" wx:key="index" bindtap="onThumbnailTap" data-url="{{item}}">
          <image src="{{item}}" mode="aspectFill"></image>
        </view>
      </scroll-view>
    </view>

    <!-- 按钮行：相册、快门、反转 -->
    <view class="button-row">
      <!-- 相册按钮 -->
      <view class="album-btn" bindtap="openAlbum">
        <text>相册</text>
      </view>

      <!-- 快门按钮 -->
      <view class="shutter-btn" bindtap="takePhoto">
        <image src="/images/快门.png" mode="widthFix"></image>
      </view>

      <!-- 镜头反转按钮 -->
      <view class="switch-camera" bindtap="switchCamera">
        <image src="/images/switch-camera.png" mode="widthFix"></image>
      </view>
    </view>
  </view>
</view>