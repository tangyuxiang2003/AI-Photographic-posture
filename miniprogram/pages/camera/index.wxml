 <!-- camera.wxml -->
<view class="camera-container" bindtap="onScreenTap">
  <!-- é¡¶éƒ¨é»‘è‰²åŠŸèƒ½åŒº -->
  <view class="top-controls">
    <view class="top-controls-inner">
      <!-- é—ªå…‰ç¯æ§åˆ¶ -->
      <view class="control-icon flash-control" bindtap="toggleFlash">
        <image src="{{flash === 'on' ? '/images/flash-on.png' : '/images/flash-off.png'}}" mode="widthFix"></image>
      </view>
      <!-- å€’è®¡æ—¶æ§åˆ¶ -->
      <view class="control-icon timer-control {{timerEnabled ? 'on' : ''}}" bindtap="toggleTimer">
        <image src="/images/timer-off.png" mode="widthFix"></image>
        <text class="timer-text">{{timerEnabled ? timerSeconds + 's' : ''}}</text>
      </view>
      <!-- å®å†µæ§åˆ¶ -->
      <view class="control-icon live-control" bindtap="toggleLive">
        <image src="{{liveEnabled ? '/images/live-on.png' : '/images/live-off.png'}}" mode="widthFix"></image>
      </view>
    </view>
  </view>

  <!-- ä¸­é—´å–æ™¯åŒºåŸŸï¼ˆè¢«ä¸Šä¸‹é»‘åŒºåŒ…å›´ï¼‰ -->
  <view class="camera-preview">
    <!-- ç›¸æœºç»„ä»¶ - å§‹ç»ˆæ¸²æŸ“ï¼Œé€šè¿‡æƒé™æ§åˆ¶åŠŸèƒ½ -->
    <camera 
      class="camera"
      device-position="{{cameraPosition}}" 
      flash="{{flash}}"
      binderror="onCameraError"
      bindstop="onCameraStop"
      bindinitdone="onCameraReady"
    ></camera>
    
    <!-- æœªæˆæƒæ—¶çš„é®ç½©å±‚ -->
    <view wx:if="{{!cameraAuthorized}}" class="camera-auth-placeholder">
      <view class="auth-icon">ğŸ“·</view>
      <view class="auth-text">éœ€è¦ç›¸æœºæƒé™</view>
      <view class="auth-desc">è¯·æˆæƒåä½¿ç”¨æ‹ç…§åŠŸèƒ½</view>
      <view class="auth-button" bindtap="requestCameraAuth">
        <text>æˆæƒç›¸æœº</text>
      </view>
    </view>
    
    <!-- ä¹å®«æ ¼è¾…åŠ©çº¿ -->
    <view class="grid-overlay">
      <view class="grid-line grid-line-v" style="left: 33.33%;"></view>
      <view class="grid-line grid-line-v" style="left: 66.66%;"></view>
      <view class="grid-line grid-line-h" style="top: 33.33%;"></view>
      <view class="grid-line grid-line-h" style="top: 66.66%;"></view>
    </view>
  </view>

  <!-- æ”¾å¤§çš„å‚è€ƒå›¾ï¼ˆæ˜¾ç¤ºåœ¨å·¦ä¸‹è§’é»‘è‰²åŒºåŸŸä¸Šæ–¹ï¼‰ -->
  <view class="enlarged-reference {{enlargedImage ? 'show' : ''}} {{isMaxEnlarged ? 'max-enlarged' : ''}}" wx:if="{{enlargedImage}}" catchtap="onCloseEnlarged">
    <image src="{{enlargedImage}}" mode="aspectFit"></image>
  </view>

  <!-- åº•éƒ¨é»‘è‰²åŠŸèƒ½åŒº -->
  <view class="bottom-controls" catchtap="stopPropagation">
    <!-- ç”Ÿæˆå›¾ç‰‡ç¼©ç•¥å›¾åˆ—è¡¨ï¼ˆæ¨ªå‘æ»šåŠ¨ï¼‰ - åŒ…å«å‚è€ƒå›¾ç‰‡ -->
    <view class="thumbnail-list" wx:if="{{referenceImage || generatedImages.length > 0}}">
      <scroll-view scroll-x="true" class="thumbnail-scroll">
        <!-- å‚è€ƒå›¾ç‰‡ç¼©ç•¥å›¾ï¼ˆå¦‚æœæœ‰ï¼‰ -->
        <view class="thumbnail-item" wx:if="{{referenceImage}}" bindtap="onThumbnailTap" data-url="{{referenceImage}}">
          <image src="{{referenceImage}}" mode="aspectFill" lazy-load="{{false}}"></image>
        </view>
        <!-- ç”Ÿæˆçš„å›¾ç‰‡ç¼©ç•¥å›¾ï¼ˆè¿‡æ»¤æ‰ä¸å‚è€ƒå›¾ç‰‡ç›¸åŒçš„ï¼‰ -->
        <view class="thumbnail-item" wx:for="{{generatedImages}}" wx:key="index" wx:if="{{item !== referenceImage}}" bindtap="onThumbnailTap" data-url="{{item}}">
          <image src="{{item}}" mode="aspectFill" lazy-load="{{false}}"></image>
        </view>
      </scroll-view>
    </view>

    <!-- æŒ‰é’®è¡Œï¼šç›¸å†Œã€å¿«é—¨ã€åè½¬ -->
    <view class="button-row">
      <!-- ç›¸å†ŒæŒ‰é’® -->
      <view class="album-btn" bindtap="openAlbum">
        <text>ç›¸å†Œ</text>
      </view>

      <!-- å¿«é—¨æŒ‰é’® -->
      <view class="shutter-btn" bindtap="takePhoto">
        <image src="/images/å¿«é—¨.png" mode="widthFix"></image>
      </view>

      <!-- é•œå¤´åè½¬æŒ‰é’® -->
      <view class="switch-camera" bindtap="switchCamera">
        <image src="/images/switch-camera.png" mode="widthFix"></image>
      </view>
    </view>
  </view>
</view>