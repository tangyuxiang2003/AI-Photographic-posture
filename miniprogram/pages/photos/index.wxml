<view class="wrap" style="background: {{themeBg}};">
  <!-- 统计与操作 -->
  <view class="stats-bar">
    <view class="stats-text">已收藏：{{favorites.length}} 条</view>
    <button class="refresh-btn" bindtap="onShuffle">换一批推荐</button>
  </view>

  <!-- 筛选标签 -->
  <scroll-view class="tabs" scroll-x="true" enable-flex>
    <view class="tab {{activeTab==='全部'?'active':''}}" data-tab="全部" bindtap="onSetTab">全部</view>
    <view class="tab {{activeTab==='风格'?'active':''}}" data-tab="风格" bindtap="onSetTab">风格</view>
    <view class="tab {{activeTab==='场景'?'active':''}}" data-tab="场景" bindtap="onSetTab">场景</view>
    <view class="tab {{activeTab==='姿势'?'active':''}}" data-tab="姿势" bindtap="onSetTab">姿势</view>
    <view class="tab {{activeTab==='道具'?'active':''}}" data-tab="道具" bindtap="onSetTab">道具</view>
  </scroll-view>

  <!-- 搜索 -->
  <view class="search-bar">
    <input class="search-input"
           placeholder="搜索关键词，如 韩系 / 花墙 / 回眸"
           value="{{query}}"
           bindinput="onSearchInput" />
    <button class="search-clear" wx:if="{{query}}" bindtap="onClearSearch">清除</button>
  </view>

  <!-- 列表 -->
  <view wx:if="{{filtered.length}}" class="card-list">
    <block wx:for="{{filtered}}" wx:key="id">
      <view class="card">
        <image class="cover" src="{{item.cover}}" mode="aspectFill"></image>
        <view class="info">
          <view class="title">{{item.title}}</view>
          <view class="tags">
            <text class="tag" wx:for="{{item.tags}}" wx:key="*this">{{item}}</text>
          </view>
          <view class="actions">
            <button class="btn unfav" data-id="{{item.id}}" bindtap="onToggleFavorite">取消收藏</button>
            <button class="btn share" data-id="{{item.id}}" open-type="share">分享</button>
            <button class="btn edit" data-id="{{item.id}}" bindtap="onOpenTagEditor">编辑风格</button>
          </view>
          <!-- 标签编辑弹层 -->
  <view wx:if="{{showTagEditor}}">
    <view class="mask" bindtap="onCloseTagEditor"></view>
    <view class="sheet">
      <view class="sheet-title">编辑风格标签</view>
      <view class="sheet-tip">用逗号分隔多个标签，如：韩系, 花墙, 回眸</view>
      <input class="sheet-input"
             placeholder="输入标签，逗号分隔"
             value="{{editingTags}}"
             bindinput="onEditTagsInput" />
      <view class="sheet-actions">
        <button class="sheet-btn cancel" bindtap="onCloseTagEditor">取消</button>
        <button class="sheet-btn save" bindtap="onSaveTags">保存</button>
      </view>
    </view>
  </view>
</view>
      </view>
    </block>
  </view>

  <!-- 空状态：无匹配 -->
  <view wx:elif="{{favorites.length && !filtered.length}}" class="empty">
    <view class="empty-title">无匹配结果</view>
    <view class="empty-tip">换个关键词或切换标签试试～</view>
  </view>

  <!-- 空状态：无收藏 -->
  <view wx:else class="empty">
    <view class="empty-title">还没有收藏</view>
    <view class="empty-tip">去首页挑选姿势建议，点击收藏即可在这里查看哦～</view>
    <navigator class="go-home" open-type="switchTab" url="/pages/index/index">去首页看看</navigator>
  </view>
</view>